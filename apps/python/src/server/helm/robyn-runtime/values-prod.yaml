# Production environment values

replicaCount: 5

image:
  repository: ghcr.io/your-org/robyn-runtime
  tag: "0.1.0"
  pullPolicy: IfNotPresent

config:
  devMode: false
  workers: 4
  supabase:
    url: "https://production-project.supabase.co"
  llm:
    openaiApiBase: "http://ministral-vllm.production.svc.cluster.local/v1"
  observability:
    langchainTracingV2: "true"
    langchainProject: "production"

resources:
  limits:
    cpu: 2000m
    memory: 2Gi
  requests:
    cpu: 500m
    memory: 1Gi

autoscaling:
  enabled: true
  minReplicas: 5
  maxReplicas: 20
  targetCPUUtilizationPercentage: 70
  targetMemoryUtilizationPercentage: 80

podDisruptionBudget:
  enabled: true
  minAvailable: 3

ingress:
  enabled: true
  className: "nginx"
  annotations:
    cert-manager.io/cluster-issuer: "letsencrypt-prod"
    nginx.ingress.kubernetes.io/rate-limit: "100"
    nginx.ingress.kubernetes.io/proxy-read-timeout: "600"
    nginx.ingress.kubernetes.io/proxy-send-timeout: "600"
  hosts:
    - host: agent-api.example.com
      paths:
        - path: /
          pathType: Prefix
  tls:
    - secretName: robyn-runtime-prod-tls
      hosts:
        - agent-api.example.com

networkPolicy:
  enabled: true

serviceMonitor:
  enabled: true
  interval: 30s

prometheusRule:
  enabled: true

# Production affinity rules for better distribution
affinity:
  podAntiAffinity:
    requiredDuringSchedulingIgnoredDuringExecution:
    - labelSelector:
        matchExpressions:
        - key: app.kubernetes.io/name
          operator: In
          values:
          - robyn-runtime
      topologyKey: kubernetes.io/hostname
  nodeAffinity:
    preferredDuringSchedulingIgnoredDuringExecution:
    - weight: 100
      preference:
        matchExpressions:
        - key: node-role.kubernetes.io/compute
          operator: In
          values:
          - "true"
